name: Deploy

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Setup Hugo and Surge
      run: |
        git clone https://github.com/gohugoio/hugo.git
        cd hugo
        go install
        go build
        chmod +x hugo
        cd ..
        npm i surge        
    - name: Build site
      run: |
        hugo/hugo -D --minify
    - name: Deploy to Surge
      env:
        SURGE_LOGIN: ${{ Secrets.SurgeLogin }}
        SURGE_TOKEN: ${{ Secrets.SurgeToken }}
      run: |
        cd public
        ../node_modules/.bin/surge . divingfor.fun
